<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-0.9.584">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">

<meta name="author" content="Dr.&nbsp;Gilbert">
<meta name="author" content="Dr.&nbsp;Duryea">

<title>Genome Assembly, Part IV</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
span.underline{text-decoration: underline;}
div.column{display: inline-block; vertical-align: top; width: 50%;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>


<script src="GenomeAssembly_PartIV_files/libs/clipboard/clipboard.min.js"></script>
<script src="GenomeAssembly_PartIV_files/libs/quarto-html/quarto.js"></script>
<script src="GenomeAssembly_PartIV_files/libs/quarto-html/popper.min.js"></script>
<script src="GenomeAssembly_PartIV_files/libs/quarto-html/tippy.umd.min.js"></script>
<script src="GenomeAssembly_PartIV_files/libs/quarto-html/anchor.min.js"></script>
<link href="GenomeAssembly_PartIV_files/libs/quarto-html/tippy.css" rel="stylesheet">
<link href="GenomeAssembly_PartIV_files/libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="GenomeAssembly_PartIV_files/libs/bootstrap/bootstrap.min.js"></script>
<link href="GenomeAssembly_PartIV_files/libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="GenomeAssembly_PartIV_files/libs/bootstrap/bootstrap.min.css" rel="stylesheet">

  <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script>

</head>

<body class="fullcontent">

<div id="quarto-content" class="page-columns page-rows-contents page-layout-article">

<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title">Genome Assembly, Part IV</h1>
</div>



<div class="quarto-title-meta">

    <div>
    <div class="quarto-title-meta-heading">Authors</div>
    <div class="quarto-title-meta-contents">
             <p>Dr.&nbsp;Gilbert </p>
             <p>Dr.&nbsp;Duryea </p>
          </div>
  </div>
    
    
  </div>
  

</header>

<section id="preliminary-thoughts" class="level2">
<h2 class="anchored" data-anchor-id="preliminary-thoughts">Preliminary Thoughts</h2>
<p>We’ve spent a lot of time in the previous three notebooks re-casting the Genome Assembly problem into different settings in order to put a general solution more within reach. We’ve identified that a problem from Graph Theory which was solved in 1735 and a problem in theoretical mathematics and computer science solved in 1946 hold the keys to our ability to solve the Genome Assembly problem. We actually aren’t too far behind “cutting-edge” bioinformatics here. The deBruijn graph technique we are now developing was first brought to bioinformatics in 1989 and is still the dominant approach for genome assembly today!</p>
<p>In this notebook we’ll continue our work towards recovering candidate genomes from Eulerian Paths in the deBruijn Graph corresponding to the <span class="math inline">\(k\)</span>-mer composition of the genome. At the end of the last notebook we developed an algorithm and function <code>eulerCircuit()</code> to construct an Eulerian Circuit from a graph, provided that one exists. We’ll continue where we left off by adapting our function to find Eulerian Paths, since those are what we truly seek.</p>
</section>
<section id="assembling-the-genome-a-more-general-solution" class="level2">
<h2 class="anchored" data-anchor-id="assembling-the-genome-a-more-general-solution">Assembling the Genome: A More General Solution</h2>
<p>The culmination of this notebook will be <em>a</em> general solution to the Genome Assembly problem, but will still be accompanied by several simplifying assumptions. The first stop in this notebook will be to move from being able to discover Eulerian Circuits in a graph to being able to construct Eulerian Paths instead. Once we achieve this objective, we’ll relax some of our remaining assumptions to accommodate real restrictions associated with the ability of bioinformaticians to generate long reads from a genome. At the close of the notebook, we’ll highlight a few of the differences between the Genome Assembly scheme we’ve come up with and the current state of the art methods employed in labs today.</p>
<section id="from-eulerian-circuits-to-eulerian-paths" class="level4">
<h4 class="anchored" data-anchor-id="from-eulerian-circuits-to-eulerian-paths">From Eulerian Circuits to Eulerian Paths</h4>
<p>Consider a graph that has an Eulerian Path but not an Eulerian Circuit. Are you convinced that such a graph exists? By now you should at least be convinced of the existence of graphs with Eulerian Circuit and the conditions that are required for these structures to exist. We can construct a graph with an Eulerian Path but no Eulerian Circuit by simply removing a single edge from a graph with an Eulerian Circuit.</p>
<hr>
<p><strong>Challenge 1:</strong> (No Code) How many <em>un-balanced</em> vertices can a graph with an Eulerian Path have? What must be true about those vertices? (Remember, a vertex in a directed graph is said to be <em>balanced</em> if its in-degree and out-degree match.)</p>
<hr>
<p>Now that you’ve thought a bit more about Eulerian Paths, you’re ready to tackle another challenge.</p>
<hr>
<p><strong>Challenge 2:</strong> Build a function, <code>eulerPath()</code>, which will find an Eulerian Path in a graph, if such a path exists.</p>
<blockquote class="blockquote">
<p><strong>Input:</strong> An edge-list corresponding to a directed graph which contains an Eulerian Path. <strong>Output:</strong> A sequence of vertices corresponding to an Eulerian Path in the input graph.</p>
</blockquote>
<hr>
<div class="cell">
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="co">#Solve the challenge problem here</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Once you’ve built your function and are satisfied that it works, head on over to Rosalind to solve the <a href="https://rosalind.info/problems/ba3g/"><em>Find an Eulerian Path in a Graph problem</em></a>.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb2"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a><span class="co">#Solve the Rosalind problem here</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>With that accomplishment in the books, you’ve now got all of the pieces you need in order to solve the Genome Assembly problem under the conditions that you are in possession of the <span class="math inline">\(k\)</span>-mers which compose the genome, for some fixed value of <span class="math inline">\(k\)</span> and you have complete coverage of the genome. To do so, simply combine the functions you’ve written to do the following:</p>
<ol type="1">
<li>Construct the deBruijn Graph from the <span class="math inline">\(k\)</span>-mer composition. (<code>deBruijnK()</code>)</li>
<li>Construct and Eulerian Path through the deBruijn Graph. (<code>eulerPath()</code>)</li>
<li>Reconstruct the genome from the Path Graph (<code>stringFromPath()</code>)</li>
</ol>
<hr>
<p><strong>Challenge 3:</strong> Create a function <code>genomeReconstruction()</code> which solves the Genome Assembly problem with full-coverage <span class="math inline">\(k\)</span>-mers.</p>
<blockquote class="blockquote">
<p><strong>Input:</strong> An integer (<code>k</code>) and a list of <span class="math inline">\(k\)</span>-mers (<code>patterns</code>). <strong>Output:</strong> A string <code>genome</code> with <span class="math inline">\(k\)</span>-mer composition equal to <code>patterns</code>.</p>
</blockquote>
<hr>
<div class="cell">
<div class="sourceCode cell-code" id="cb3"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a><span class="co">#Solve the challenge problem here</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Once you’ve solved that challenge, verify your solution by heading to Rosalind and solving the <a href="https://rosalind.info/problems/ba3h/"><em>Reconstruct a String from its <span class="math inline">\(k\)</span>-mer Composition</em> problem</a>.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb4"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a><span class="co">#Solve the Rosalind problem here</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p><strong>NOTE:</strong> I’M SKIPPING THE INCLUSION OF SOLVING THE <span class="math inline">\(k\)</span>-UNIVERSAL BINARY STRING PROBLEM FOR NOW. I DON’T THINK ITS SOLUTION IS NECESSARY TO PROCEED.</p>
</section>
<section id="assembling-the-genome-from-read-pairs" class="level4">
<h4 class="anchored" data-anchor-id="assembling-the-genome-from-read-pairs">Assembling the Genome From Read-Pairs</h4>
<p>In our most recent solution to the Genome Assembly problem we assumed that we had obtained a set of <span class="math inline">\(k\)</span>-mers with complete coverage of the genome. Unfortunately, this assumption is not possible given current read-technology in bioinformatics. Genomes can be millions of nucleotides long, but current read technology can produce reliable reads over only a few hundred consecutive nucleotides. The Genome Assembly problem is also harder than we’ve let on because real genomes exibit long patterns which repeat throughout the genome (remember those DNAa boxes from our first unit?). These repeating patterns make it possible for multiple distinct Eulerian Paths to exist within the deBruijn Graph of the <span class="math inline">\(k\)</span>-mer composition of our genome. Since multiple distinct Eulerian Paths exist, we’ll obtain multiple candidates for the assembled genome.</p>
<p>Unfortunately, there’s not much we can do to combat the repeating patterns problem. There are, however, some strategies which are useful in getting around the limited ability to produce reads out of a genome.</p>
<p><strong>Definition (Read-Pairs):</strong> Biologist have devised quite an ingenious approach to increasing the read length by generating <em>read-pairs</em>, which are pairs of reads separated by a fixed distance <span class="math inline">\(d\)</span> within the genome. These reads are long, gapped reads in which we obtain <span class="math inline">\(k\)</span> nucleotides, followed by a gap of <span class="math inline">\(d\)</span> nucleotides, and then another read of <span class="math inline">\(k\)</span> nucleotides. The result is a read over <span class="math inline">\(k + d + k\)</span> consecutive nucleotides in the genome.</p>
<p>The following ideas need to be included in this notebook:</p>
<ul>
<li>Transforming read-pairs into <em>long virtual reads</em></li>
<li>Paired composition and <span class="math inline">\(\left(k, d\right)\)</span>-mers of the form <span class="math inline">\(\left(\overbrace{\texttt{Pattern 1}}^{k} |\underbrace{\cdots}_{d} |\overbrace{\texttt{Pattern 2}}^{k}\right)\)</span></li>
<li>Paired deBruijn Graphs</li>
<li>A Pitfall of paired deBruijn Graphs</li>
<li><a href="https://rosalind.info/problems/ba3j/"><em>String Reconstruction from Read-Pairs</em> problem</a></li>
</ul>
</section>
</section>
<section id="summary" class="level2">
<h2 class="anchored" data-anchor-id="summary">Summary</h2>
<p>In this intro notebook, we’ve accomplished the following.</p>
<ul>
<li>Something we accomplished…</li>
</ul>
<p>See you in the next notebook.</p>
</section>

</main>
<!-- /main column -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    target: function(trigger) {
      return trigger.previousElementSibling;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    setTimeout(function() {
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  function tippyHover(el, contentFn) {
    const config = {
      allowHTML: true,
      content: contentFn,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start'
    };
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      let href = ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const cites = ref.parentNode.getAttribute('data-cites').split(' ');
    tippyHover(ref, function() {
      var popup = window.document.createElement('div');
      cites.forEach(function(cite) {
        var citeDiv = window.document.createElement('div');
        citeDiv.classList.add('hanging-indent');
        citeDiv.classList.add('csl-entry');
        var biblioDiv = window.document.getElementById('ref-' + cite);
        if (biblioDiv) {
          citeDiv.innerHTML = biblioDiv.innerHTML;
        }
        popup.appendChild(citeDiv);
      });
      return popup.innerHTML;
    });
  }
});
</script>
</div> <!-- /content -->



</body></html>